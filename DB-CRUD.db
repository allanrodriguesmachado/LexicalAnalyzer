SELECT * FROM pessoa;
SELECT * FROM address;

-- CRUD COMPLETO
SELECT * FROM pessoa;
SELECT * FROM address;


--SELECT
SELECT id_pessoa, nome, rua|| ', ' ||
                        COALESCE(numero::VARCHAR, 'S/N') AS numero,
       TO_CHAR(ts_inclusao,'DD/MM/YYYY HH24:MI:SS') PersonInformation,
       TO_CHAR(ts_cancelamento, 'HH24:MI:SS') CancelInformation
FROM pessoa
         JOIN address ON  pessoa.id_address = address.id_address
WHERE nome ILIKE '%a%' AND rua ILIKE '%m%'
ORDER BY id_pessoa;

-- UPDATE
UPDATE pessoa SET ts_cancelamento = now() WHERE id_pessoa > 1;

-- INSERT
INSERT INTO pessoa
VALUES (11,'Ana',now(),11,now(),false )
    RETURNING *;

INSERT INTO address
VALUES(11, 'Amazonas', 21, 'Fe', 'Ferraz')
    RETURNING *;

-- DELETE
DELETE FROM pessoa WHERE id_pessoa = 9;

-- WHERE IS NOT NULL
SELECT id_pessoa, nome, rua|| ', ' ||
                        COALESCE(numero::VARCHAR, 'S/N') AS numero,
       TO_CHAR(ts_inclusao,'DD/MM/YYYY HH24:MI:SS') PersonInformation,
       TO_CHAR(ts_cancelamento, 'HH24:MI:SS') CancelInformation
FROM pessoa
         JOIN address ON  pessoa.id_address = address.id_address
WHERE nome IS NOT NULL AND numero IS NOT NULL
ORDER BY id_pessoa;

-- WHERE IS NULL
SELECT id_pessoa, nome, rua|| ', ' ||
                        COALESCE(numero::VARCHAR, 'S/N') AS numero,
       TO_CHAR(ts_inclusao,'DD/MM/YYYY HH24:MI:SS') PersonInformation,
       TO_CHAR(ts_cancelamento, 'HH24:MI:SS') CancelInformation
FROM pessoa
         JOIN address ON  pessoa.id_address = address.id_address
WHERE numero ISNULL OR nome ISNULL
ORDER BY id_pessoa;
